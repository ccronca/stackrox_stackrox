{
  "swagger": "2.0",
  "info": {
    "title": "api/v1/delegated_registry_config_service.proto",
    "version": "version not set"
  },
  "tags": [
    {
      "name": "DelegatedRegistryConfigService"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/v1/delegatedregistryconfig": {
      "get": {
        "summary": "GetConfig returns the current delegated registry configuration",
        "operationId": "DelegatedRegistryConfigService_GetConfig",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1DelegatedRegistryConfig"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "tags": [
          "DelegatedRegistryConfigService"
        ]
      },
      "put": {
        "summary": "UpdateConfig updates the stored delegated registry configuration",
        "operationId": "DelegatedRegistryConfigService_UpdateConfig",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1DelegatedRegistryConfig"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "DelegatedRegistryConfig determines if and where scan requests are delegated to, such as kept in\ncentral services or sent to particular secured clusters.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1DelegatedRegistryConfig"
            }
          }
        ],
        "tags": [
          "DelegatedRegistryConfigService"
        ]
      }
    },
    "/v1/delegatedregistryconfig/clusters": {
      "get": {
        "summary": "GetClusters returns the list of clusters (id + name) and a flag indicating whether or not\nthe cluster is valid for use in the delegated registry config",
        "operationId": "DelegatedRegistryConfigService_GetClusters",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1DelegatedRegistryClustersResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "tags": [
          "DelegatedRegistryConfigService"
        ]
      }
    }
  },
  "definitions": {
    "DelegatedRegistryConfigDelegatedRegistry": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "title": "Registry + optional path, ie: quay.example.com/prod"
        },
        "clusterId": {
          "type": "string",
          "title": "ID of the cluster to delegate ad-hoc requests to"
        }
      }
    },
    "DelegatedRegistryConfigEnabledFor": {
      "type": "string",
      "enum": [
        "NONE",
        "ALL",
        "SPECIFIC"
      ],
      "default": "NONE",
      "title": "- NONE: Scan all images via central services except for images from the OCP integrated registry\n - ALL: Scan all images via the secured clusters\n - SPECIFIC: Scan images that match `registries` or are from the OCP integrated registry via the secured clusters\notherwise scan via central services"
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "v1DelegatedRegistryCluster": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "isValid": {
          "type": "boolean"
        }
      }
    },
    "v1DelegatedRegistryClustersResponse": {
      "type": "object",
      "properties": {
        "clusters": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1DelegatedRegistryCluster"
          }
        }
      }
    },
    "v1DelegatedRegistryConfig": {
      "type": "object",
      "properties": {
        "enabledFor": {
          "$ref": "#/definitions/DelegatedRegistryConfigEnabledFor",
          "title": "Determines if delegation is enabled for no registries, all registries, or specific registries"
        },
        "defaultClusterId": {
          "type": "string",
          "title": "The default cluster to delegate ad-hoc requests to if no match found in registries, not used\nif `enabled for` is NONE"
        },
        "registries": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/DelegatedRegistryConfigDelegatedRegistry"
          },
          "description": "If `enabled for` is NONE registries has no effect.\n\nIf `ALL` registries directs ad-hoc requests to the specified secured clusters if the path matches.\n\nIf `SPECIFIC` registries directs ad-hoc requests to the specified secured clusters just like with `ALL`,\nbut in addition images that match the specified paths will be scanned locally by the secured clusters\n(images from the OCP integrated registry are always scanned locally). Images that do not match a path\nwill be scanned via central services"
        }
      },
      "description": "DelegatedRegistryConfig determines if and where scan requests are delegated to, such as kept in\ncentral services or sent to particular secured clusters."
    }
  }
}
