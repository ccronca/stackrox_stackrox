{
  "swagger": "2.0",
  "info": {
    "title": "api/v1/db_service.proto",
    "version": "version not set"
  },
  "tags": [
    {
      "name": "DBService"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/v1/db/exportcaps": {
      "get": {
        "operationId": "DBService_GetExportCapabilities",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1GetDBExportCapabilitiesResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "tags": [
          "DBService"
        ]
      }
    },
    "/v1/db/interruptrestore/{processId}/{attemptId}": {
      "post": {
        "operationId": "DBService_InterruptRestoreProcess",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1InterruptDBRestoreProcessResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "processId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "attemptId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "DBService"
        ]
      }
    },
    "/v1/db/restore": {
      "get": {
        "operationId": "DBService_GetActiveRestoreProcess",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1GetActiveDBRestoreProcessResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "tags": [
          "DBService"
        ]
      }
    },
    "/v1/db/restore/{id}": {
      "delete": {
        "operationId": "DBService_CancelRestoreProcess",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Empty"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "DBService"
        ]
      }
    }
  },
  "definitions": {
    "DBExportManifestEncodingType": {
      "type": "string",
      "enum": [
        "UNKNOWN",
        "UNCOMPREESSED",
        "DEFLATED"
      ],
      "default": "UNKNOWN",
      "description": "The encoding of the file data in the restore body, usually for compression purposes."
    },
    "DBRestoreProcessStatusResumeInfo": {
      "type": "object",
      "properties": {
        "pos": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "DBRestoreProcessStatusState": {
      "type": "string",
      "enum": [
        "UNKNOWN",
        "NOT_STARTED",
        "IN_PROGRESS",
        "PAUSED",
        "COMPLETED"
      ],
      "default": "UNKNOWN",
      "title": "- COMPLETED: successful if error is empty, unsuccessful otherwise"
    },
    "DBRestoreRequestHeaderLocalFileInfo": {
      "type": "object",
      "properties": {
        "path": {
          "type": "string",
          "description": "The full path of the file."
        },
        "bytesSize": {
          "type": "string",
          "format": "int64",
          "description": "The size of the file, in bytes. 0 if unknown."
        }
      },
      "description": "LocalFileInfo provides information about the file on the local machine of the user initiating the restore\nprocess, in order to provide information to other users about ongoing restore processes."
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "v1DBExportFormat": {
      "type": "object",
      "properties": {
        "formatName": {
          "type": "string"
        },
        "files": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1DBExportFormatFile"
          }
        }
      },
      "description": "DBExportFormat describes a format (= a collection of files) for the database export."
    },
    "v1DBExportFormatFile": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "optional": {
          "type": "boolean"
        }
      }
    },
    "v1DBExportManifest": {
      "type": "object",
      "properties": {
        "files": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1DBExportManifestFile"
          }
        }
      },
      "description": "A DB export manifest describes the file contents of a restore request. To prevent data loss, a manifest is always\ninterpreted as binding, i.e., the server must ensure that it will read and make use of every file listed in the\nmanifest, otherwise it must reject the request."
    },
    "v1DBExportManifestFile": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the file. This may or may not be a (relative) file path and up to the server to interpret.\nFor databases exported as ZIP files, this is the path relative to the root of the archive."
        },
        "encoding": {
          "$ref": "#/definitions/DBExportManifestEncodingType"
        },
        "encodedSize": {
          "type": "string",
          "format": "int64"
        },
        "decodedSize": {
          "type": "string",
          "format": "int64"
        },
        "decodedCrc32": {
          "type": "integer",
          "format": "int64",
          "description": "The CRC32 (IEEE) checksum of the decoded(!) data."
        }
      },
      "description": "A single file in the restore body."
    },
    "v1DBRestoreProcessMetadata": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "An ID identifying the restore process. Auto-assigned."
        },
        "header": {
          "$ref": "#/definitions/v1DBRestoreRequestHeader",
          "description": "The header with which the restore was initiated."
        },
        "startTime": {
          "type": "string",
          "format": "date-time",
          "description": "The time at which the restore process was started."
        },
        "initiatingUserName": {
          "type": "string",
          "description": "The user who initiated the database restore process."
        }
      },
      "description": "The metadata of an ongoing or completed restore process. This is the *static* metadata, which will not change\n(i.e., it is not a status)."
    },
    "v1DBRestoreProcessStatus": {
      "type": "object",
      "properties": {
        "metadata": {
          "$ref": "#/definitions/v1DBRestoreProcessMetadata"
        },
        "attemptId": {
          "type": "string"
        },
        "state": {
          "$ref": "#/definitions/DBRestoreProcessStatusState"
        },
        "resumeInfo": {
          "$ref": "#/definitions/DBRestoreProcessStatusResumeInfo",
          "title": "only populated if state is PAUSED"
        },
        "error": {
          "type": "string",
          "title": "only populated when state is COMPLETED"
        },
        "bytesRead": {
          "type": "string",
          "format": "int64",
          "title": "Payload bytes read so far (approximate)"
        },
        "filesProcessed": {
          "type": "string",
          "format": "int64",
          "title": "Files processed so far (approximate)"
        }
      }
    },
    "v1DBRestoreRequestHeader": {
      "type": "object",
      "properties": {
        "formatName": {
          "type": "string",
          "description": "The name of the database export format. Mandatory."
        },
        "manifest": {
          "$ref": "#/definitions/v1DBExportManifest",
          "description": "A manifest of all the files in the restore data. The remainder of a restore request body (without the header),\nindependent of the export format, is always a concatenation of all encoded file data, with no separators in\nbetween (determined purely by the order and sizes listed in the manifest)."
        },
        "localFile": {
          "$ref": "#/definitions/DBRestoreRequestHeaderLocalFileInfo",
          "description": "Information about the local file with which the restore was initiated. Optional."
        }
      }
    },
    "v1Empty": {
      "type": "object"
    },
    "v1GetActiveDBRestoreProcessResponse": {
      "type": "object",
      "properties": {
        "activeStatus": {
          "$ref": "#/definitions/v1DBRestoreProcessStatus"
        }
      }
    },
    "v1GetDBExportCapabilitiesResponse": {
      "type": "object",
      "properties": {
        "formats": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1DBExportFormat"
          }
        },
        "supportedEncodings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/DBExportManifestEncodingType"
          }
        }
      }
    },
    "v1InterruptDBRestoreProcessResponse": {
      "type": "object",
      "properties": {
        "resumeInfo": {
          "$ref": "#/definitions/DBRestoreProcessStatusResumeInfo"
        }
      }
    }
  }
}
