{
  "swagger": "2.0",
  "info": {
    "title": "api/v1/search_service.proto",
    "version": "version not set"
  },
  "tags": [
    {
      "name": "SearchService"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/v1/search": {
      "get": {
        "operationId": "SearchService_Search",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1SearchResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "query",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "categories",
            "in": "query",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "SEARCH_UNSET",
                "ALERTS",
                "IMAGES",
                "IMAGE_COMPONENTS",
                "IMAGE_VULN_EDGE",
                "IMAGE_COMPONENT_EDGE",
                "POLICIES",
                "DEPLOYMENTS",
                "ACTIVE_COMPONENT",
                "PODS",
                "SECRETS",
                "PROCESS_INDICATORS",
                "COMPLIANCE",
                "CLUSTERS",
                "NAMESPACES",
                "NODES",
                "NODE_COMPONENTS",
                "NODE_VULN_EDGE",
                "NODE_COMPONENT_EDGE",
                "NODE_COMPONENT_CVE_EDGE",
                "COMPLIANCE_STANDARD",
                "COMPLIANCE_CONTROL_GROUP",
                "COMPLIANCE_CONTROL",
                "SERVICE_ACCOUNTS",
                "ROLES",
                "ROLEBINDINGS",
                "REPORT_CONFIGURATIONS",
                "PROCESS_BASELINES",
                "SUBJECTS",
                "RISKS",
                "VULNERABILITIES",
                "CLUSTER_VULNERABILITIES",
                "IMAGE_VULNERABILITIES",
                "NODE_VULNERABILITIES",
                "COMPONENT_VULN_EDGE",
                "CLUSTER_VULN_EDGE",
                "NETWORK_ENTITY",
                "VULN_REQUEST",
                "NETWORK_BASELINE",
                "NETWORK_POLICIES",
                "PROCESS_BASELINE_RESULTS",
                "COMPLIANCE_METADATA",
                "COMPLIANCE_RESULTS",
                "COMPLIANCE_DOMAIN",
                "CLUSTER_HEALTH",
                "POLICY_CATEGORIES",
                "IMAGE_INTEGRATIONS",
                "COLLECTIONS",
                "POLICY_CATEGORY_EDGE",
                "PROCESS_LISTENING_ON_PORT",
                "API_TOKEN",
                "REPORT_METADATA",
                "REPORT_SNAPSHOT",
                "COMPLIANCE_INTEGRATIONS",
                "COMPLIANCE_SCAN_CONFIG",
                "COMPLIANCE_SCAN",
                "COMPLIANCE_CHECK_RESULTS",
                "BLOB",
                "ADMINISTRATION_EVENTS",
                "COMPLIANCE_SCAN_CONFIG_STATUS",
                "ADMINISTRATION_USAGE",
                "COMPLIANCE_PROFILES",
                "COMPLIANCE_PROFILE_CLUSTER_EDGE",
                "COMPLIANCE_RULES",
                "COMPLIANCE_SCAN_SETTING_BINDINGS",
                "COMPLIANCE_SUITES",
                "CLOUD_SOURCES",
                "DISCOVERED_CLUSTERS"
              ]
            },
            "collectionFormat": "multi"
          }
        ],
        "tags": [
          "SearchService"
        ]
      }
    },
    "/v1/search/autocomplete": {
      "get": {
        "operationId": "SearchService_Autocomplete",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1AutocompleteResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "query",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "categories",
            "in": "query",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "SEARCH_UNSET",
                "ALERTS",
                "IMAGES",
                "IMAGE_COMPONENTS",
                "IMAGE_VULN_EDGE",
                "IMAGE_COMPONENT_EDGE",
                "POLICIES",
                "DEPLOYMENTS",
                "ACTIVE_COMPONENT",
                "PODS",
                "SECRETS",
                "PROCESS_INDICATORS",
                "COMPLIANCE",
                "CLUSTERS",
                "NAMESPACES",
                "NODES",
                "NODE_COMPONENTS",
                "NODE_VULN_EDGE",
                "NODE_COMPONENT_EDGE",
                "NODE_COMPONENT_CVE_EDGE",
                "COMPLIANCE_STANDARD",
                "COMPLIANCE_CONTROL_GROUP",
                "COMPLIANCE_CONTROL",
                "SERVICE_ACCOUNTS",
                "ROLES",
                "ROLEBINDINGS",
                "REPORT_CONFIGURATIONS",
                "PROCESS_BASELINES",
                "SUBJECTS",
                "RISKS",
                "VULNERABILITIES",
                "CLUSTER_VULNERABILITIES",
                "IMAGE_VULNERABILITIES",
                "NODE_VULNERABILITIES",
                "COMPONENT_VULN_EDGE",
                "CLUSTER_VULN_EDGE",
                "NETWORK_ENTITY",
                "VULN_REQUEST",
                "NETWORK_BASELINE",
                "NETWORK_POLICIES",
                "PROCESS_BASELINE_RESULTS",
                "COMPLIANCE_METADATA",
                "COMPLIANCE_RESULTS",
                "COMPLIANCE_DOMAIN",
                "CLUSTER_HEALTH",
                "POLICY_CATEGORIES",
                "IMAGE_INTEGRATIONS",
                "COLLECTIONS",
                "POLICY_CATEGORY_EDGE",
                "PROCESS_LISTENING_ON_PORT",
                "API_TOKEN",
                "REPORT_METADATA",
                "REPORT_SNAPSHOT",
                "COMPLIANCE_INTEGRATIONS",
                "COMPLIANCE_SCAN_CONFIG",
                "COMPLIANCE_SCAN",
                "COMPLIANCE_CHECK_RESULTS",
                "BLOB",
                "ADMINISTRATION_EVENTS",
                "COMPLIANCE_SCAN_CONFIG_STATUS",
                "ADMINISTRATION_USAGE",
                "COMPLIANCE_PROFILES",
                "COMPLIANCE_PROFILE_CLUSTER_EDGE",
                "COMPLIANCE_RULES",
                "COMPLIANCE_SCAN_SETTING_BINDINGS",
                "COMPLIANCE_SUITES",
                "CLOUD_SOURCES",
                "DISCOVERED_CLUSTERS"
              ]
            },
            "collectionFormat": "multi"
          }
        ],
        "tags": [
          "SearchService"
        ]
      }
    },
    "/v1/search/metadata/options": {
      "get": {
        "operationId": "SearchService_Options",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1SearchOptionsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "categories",
            "in": "query",
            "required": false,
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "SEARCH_UNSET",
                "ALERTS",
                "IMAGES",
                "IMAGE_COMPONENTS",
                "IMAGE_VULN_EDGE",
                "IMAGE_COMPONENT_EDGE",
                "POLICIES",
                "DEPLOYMENTS",
                "ACTIVE_COMPONENT",
                "PODS",
                "SECRETS",
                "PROCESS_INDICATORS",
                "COMPLIANCE",
                "CLUSTERS",
                "NAMESPACES",
                "NODES",
                "NODE_COMPONENTS",
                "NODE_VULN_EDGE",
                "NODE_COMPONENT_EDGE",
                "NODE_COMPONENT_CVE_EDGE",
                "COMPLIANCE_STANDARD",
                "COMPLIANCE_CONTROL_GROUP",
                "COMPLIANCE_CONTROL",
                "SERVICE_ACCOUNTS",
                "ROLES",
                "ROLEBINDINGS",
                "REPORT_CONFIGURATIONS",
                "PROCESS_BASELINES",
                "SUBJECTS",
                "RISKS",
                "VULNERABILITIES",
                "CLUSTER_VULNERABILITIES",
                "IMAGE_VULNERABILITIES",
                "NODE_VULNERABILITIES",
                "COMPONENT_VULN_EDGE",
                "CLUSTER_VULN_EDGE",
                "NETWORK_ENTITY",
                "VULN_REQUEST",
                "NETWORK_BASELINE",
                "NETWORK_POLICIES",
                "PROCESS_BASELINE_RESULTS",
                "COMPLIANCE_METADATA",
                "COMPLIANCE_RESULTS",
                "COMPLIANCE_DOMAIN",
                "CLUSTER_HEALTH",
                "POLICY_CATEGORIES",
                "IMAGE_INTEGRATIONS",
                "COLLECTIONS",
                "POLICY_CATEGORY_EDGE",
                "PROCESS_LISTENING_ON_PORT",
                "API_TOKEN",
                "REPORT_METADATA",
                "REPORT_SNAPSHOT",
                "COMPLIANCE_INTEGRATIONS",
                "COMPLIANCE_SCAN_CONFIG",
                "COMPLIANCE_SCAN",
                "COMPLIANCE_CHECK_RESULTS",
                "BLOB",
                "ADMINISTRATION_EVENTS",
                "COMPLIANCE_SCAN_CONFIG_STATUS",
                "ADMINISTRATION_USAGE",
                "COMPLIANCE_PROFILES",
                "COMPLIANCE_PROFILE_CLUSTER_EDGE",
                "COMPLIANCE_RULES",
                "COMPLIANCE_SCAN_SETTING_BINDINGS",
                "COMPLIANCE_SUITES",
                "CLOUD_SOURCES",
                "DISCOVERED_CLUSTERS"
              ]
            },
            "collectionFormat": "multi"
          }
        ],
        "tags": [
          "SearchService"
        ]
      }
    }
  },
  "definitions": {
    "SearchResponseCount": {
      "type": "object",
      "properties": {
        "category": {
          "$ref": "#/definitions/v1SearchCategory"
        },
        "count": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "SearchResultMatches": {
      "type": "object",
      "properties": {
        "values": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "v1AutocompleteResponse": {
      "type": "object",
      "properties": {
        "values": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "v1SearchCategory": {
      "type": "string",
      "enum": [
        "SEARCH_UNSET",
        "ALERTS",
        "IMAGES",
        "IMAGE_COMPONENTS",
        "IMAGE_VULN_EDGE",
        "IMAGE_COMPONENT_EDGE",
        "POLICIES",
        "DEPLOYMENTS",
        "ACTIVE_COMPONENT",
        "PODS",
        "SECRETS",
        "PROCESS_INDICATORS",
        "COMPLIANCE",
        "CLUSTERS",
        "NAMESPACES",
        "NODES",
        "NODE_COMPONENTS",
        "NODE_VULN_EDGE",
        "NODE_COMPONENT_EDGE",
        "NODE_COMPONENT_CVE_EDGE",
        "COMPLIANCE_STANDARD",
        "COMPLIANCE_CONTROL_GROUP",
        "COMPLIANCE_CONTROL",
        "SERVICE_ACCOUNTS",
        "ROLES",
        "ROLEBINDINGS",
        "REPORT_CONFIGURATIONS",
        "PROCESS_BASELINES",
        "SUBJECTS",
        "RISKS",
        "VULNERABILITIES",
        "CLUSTER_VULNERABILITIES",
        "IMAGE_VULNERABILITIES",
        "NODE_VULNERABILITIES",
        "COMPONENT_VULN_EDGE",
        "CLUSTER_VULN_EDGE",
        "NETWORK_ENTITY",
        "VULN_REQUEST",
        "NETWORK_BASELINE",
        "NETWORK_POLICIES",
        "PROCESS_BASELINE_RESULTS",
        "COMPLIANCE_METADATA",
        "COMPLIANCE_RESULTS",
        "COMPLIANCE_DOMAIN",
        "CLUSTER_HEALTH",
        "POLICY_CATEGORIES",
        "IMAGE_INTEGRATIONS",
        "COLLECTIONS",
        "POLICY_CATEGORY_EDGE",
        "PROCESS_LISTENING_ON_PORT",
        "API_TOKEN",
        "REPORT_METADATA",
        "REPORT_SNAPSHOT",
        "COMPLIANCE_INTEGRATIONS",
        "COMPLIANCE_SCAN_CONFIG",
        "COMPLIANCE_SCAN",
        "COMPLIANCE_CHECK_RESULTS",
        "BLOB",
        "ADMINISTRATION_EVENTS",
        "COMPLIANCE_SCAN_CONFIG_STATUS",
        "ADMINISTRATION_USAGE",
        "COMPLIANCE_PROFILES",
        "COMPLIANCE_PROFILE_CLUSTER_EDGE",
        "COMPLIANCE_RULES",
        "COMPLIANCE_SCAN_SETTING_BINDINGS",
        "COMPLIANCE_SUITES",
        "CLOUD_SOURCES",
        "DISCOVERED_CLUSTERS"
      ],
      "default": "SEARCH_UNSET",
      "title": "Next available tag: 70"
    },
    "v1SearchOptionsResponse": {
      "type": "object",
      "properties": {
        "options": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "v1SearchResponse": {
      "type": "object",
      "properties": {
        "results": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1SearchResult"
          }
        },
        "counts": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/SearchResponseCount"
          }
        }
      }
    },
    "v1SearchResult": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "category": {
          "$ref": "#/definitions/v1SearchCategory"
        },
        "fieldToMatches": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/SearchResultMatches"
          }
        },
        "score": {
          "type": "number",
          "format": "double"
        },
        "location": {
          "type": "string",
          "description": "Location is intended to be a unique, yet human readable,\nidentifier for the result. For example, for a deployment,\nthe location will be \"$cluster_name/$namespace/$deployment_name.\nIt is displayed in the UI in the global search results, underneath\nthe name for each result."
        }
      }
    }
  }
}
