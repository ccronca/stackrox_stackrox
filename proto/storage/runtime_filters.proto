syntax = "proto3";

package storage;

option go_package = "./;storage";
option java_package = "io.stackrox.proto.storage";

message RuntimeFilter {
  enum RuntimeFilterFeatures {
    EXTERNAL_IPS = 0;
    PROCESSES = 1;
    NETWORK_CONNECTIONS = 2;
    LISTENING_ENDPOINTS = 3;
  }

  message RuntimeFilterRule {
    string resource_collection_id = 1;
    string status = 2;
  }

  RuntimeFilterFeatures feature = 1;
  string default_status = 2;
  repeated RuntimeFilterRule rules = 3;
}

message RuntimeFilteringConfiguration {
  repeated storage.RuntimeFilter runtime_filters = 1;
  repeated storage.ResourceCollection resource_collections = 2;
}
